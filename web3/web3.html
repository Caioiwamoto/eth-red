<script type="text/javascript">
  const defaultAccount = web3.eth.accounts[0];

  console.log("defaultAccount", defaultAccount);
  console.log("blah", web3.eth.accounts[0]);

  RED.nodes.registerType('web3',{
      category: 'function',
      color: '#a6bbcf',
      defaults: {
          name: {value: ""},
          account: {value: defaultAccount}
      },
      inputs:1,
      outputs:1,
      icon: "file.png",
      label: function() {
          return this.name||"web3";
      },
      oneditprepare: function () {
        const select = document.getElementById("node-input-account");
        for (const [i, account] of web3.eth.accounts.entries()){
           console.log("account", account);
           const option = document.createElement("option");
           option.value = account;
           option.text = account
           select.add(option);
        }
      }
  });

</script>

<script type="text/x-red" data-template-name="web3">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-account"><i class="icon-tag"></i> Account</label>
        <select id="node-input-account">
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="web3">
    <p>Connect to a web3 client</p>
</script>
